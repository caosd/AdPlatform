<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stomato.dao.AdResourceDao">
	<resultMap type="com.stomato.domain.AdResource" id="adResource"> 
		<result property="id" column="id" />
		<result property="channelId" column="channel_id" />
		<result property="adName" column="ad_name" />
		<result property="adTitle" column="ad_title" />
		<result property="adIcon" column="ad_icon" />
		<result property="adBanner" column="ad_banner" />
		<result property="desktopIcon" column="desktop_icon" />
		<result property="appPackage" column="app_package" />
		<result property="fileSize" column="file_size" />
		<result property="version" column="version" />
		<result property="supportPlatform" column="support_platform" />
		<result property="appTypeId" column="app_type_id" />
		<result property="chargeType" column="charge_type" />
		<result property="price" column="price" />
		<result property="clearingForm" column="clearing_form" />
		<result property="downloads" column="downloads" />
		<result property="recommens" column="recommens" />
		<result property="appRating" column="app_rating" />
		<result property="description" column="description" />
		<result property="modifyDate" column="modify_date" />
		<result property="createDate" column="create_date" />
		<result property="apkUrl" column="apk_url" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="status" column="status" />
		<result property="isDel" column="is_del" />
	</resultMap>
	
	<insert id="addAdResource" parameterType="com.stomato.domain.AdResource">
		insert into t_ad_rssource (
			channel_id, 
			ad_name, 
			ad_title, 
			ad_icon, 
			ad_banner, 
			desktop_icon, 
			ad_images, 
			app_package, 
			file_size, 
			version, 
			support_platform, 
			app_type_id, 
			charge_type, 
			price, 
			clearing_form, 
			downloads, 
			recommens, 
			app_rating, 
			description, 
			modify_date, 
			create_date, 
			apk_url, 
			start_time, 
			end_time, 
			status, 
			is_del) 
		values (#{channelId},
			#{adName},
			#{adTitle},
			#{adIcon},
			#{adBanner},
			#{desktopIcon},
			#{adImages},
			#{appPackage},
			#{fileSize},
			#{version},
			#{supportPlatform},
			#{appTypeId},
			#{chargeType},
			#{price},
			#{clearingForm},
			#{downloads},
			#{recommens},
			#{appRating},
			#{description},
			#{modifyDate},
			now(),
			#{apkUrl},
			#{startTime},
			#{endTime},
			1,
			1)
	</insert>
	
	<select id="hasPackage" parameterType="string" resultType="int" >
		select count(1) from t_ad_rssource where app_package = #{appPackage}
	</select>
	
	<select id="getAdResource" parameterType="int" resultMap="adResource" >
		select id,
				channel_id, 
				ad_name, 
				ad_title, 
				ad_icon, 
				ad_banner, 
				desktop_icon, 
				ad_images, 
				app_package, 
				file_size, 
				version, 
				support_platform, 
				app_type_id, 
				charge_type, 
				price, 
				clearing_form, 
				downloads, 
				recommens, 
				app_rating, 
				description, 
				modify_date, 
				create_date, 
				apk_url, 
				start_time, 
				end_time, 
				status, 
				is_del 
		from t_ad_rssource where id=? 
	</select>
	<update id="updateAdResource" parameterType="com.stomato.domain.AdResource">
		update t_ad_rssource set channel_id = ?, 
								ad_name = ?, 
								ad_title = ?, 
								ad_icon = ?, 
								ad_banner = ?, 
								desktop_icon = ?, 
								ad_images = ?, 
								app_package = ?, 
								file_size = ?, 
								version = ?, 
								support_platform = ?, 
								app_type_id = ?, 
								charge_type = ?, 
								price = ?, 
								clearing_form = ?, 
								downloads = ?, 
								recommens = ?, 
								app_rating = ?, 
								description = ?, 
								modify_date = now(),
								apk_url = ?, 
								start_time = ?, 
								end_time = ?, 
								status = ?, 
								is_del = ?
        where id = ?
	</update>
	<select id="listTotal" parameterType="com.stomato.domain.AdResource" resultType="int">
		select count(1) from t_ad_rssource where 1=1
		<if test="adName != null">
		 	and ad_name like '%${adName}%'
		</if>
	</select>
	<select id="listAdResource" parameterType="com.stomato.domain.BaseParam" resultMap="adResource" >
		select  id,
				channel_id, 
				ad_name, 
				ad_title, 
				ad_icon, 
				ad_banner, 
				desktop_icon, 
				ad_images, 
				app_package, 
				file_size, 
				version, 
				support_platform, 
				app_type_id, 
				charge_type, 
				price, 
				clearing_form, 
				downloads, 
				recommens, 
				app_rating, 
				description, 
				modify_date, 
				create_date, 
				apk_url, 
				start_time, 
				end_time, 
				status, 
				is_del
		from t_ad_rssource where 1=1 
		<if test="param != null">
			<if test="param.adName != null">
			 	and ad_name like '%${param.adName}%'
			</if>
		</if>
		order by modify_date asc
		<if test="slimt != null">limit #{slimt},#{pageSize}</if>
	</select>
</mapper>